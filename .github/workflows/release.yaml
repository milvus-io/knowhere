name: Release Build

# This workflow is triggered on pushes or pull request to the repository.
on:
  workflow_dispatch:

jobs:
  release:
    name: Release on ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    timeout-minutes: 60
    strategy:
      fail-fast: true
      matrix:
        os: [ ubuntu-18.04, macos-11]
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install Dependency
        run: |
          ./build/install_deps.sh         
      - name: Run Unittest
        run: |
          ./build.sh -t Release -u && cmake_build/unittest/test_knowhere
